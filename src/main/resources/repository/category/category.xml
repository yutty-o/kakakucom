<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kakakucom.repository.CategoryRepository">

    <select id="findAllLargeCategories" resultType="kakakucom.model.LargeCategory">
        <include refid="SelectLargeCategory" />
        ORDER BY
            sort_no ASC;
    </select>

    <select id="findOneLargeCategory" resultType="kakakucom.model.LargeCategory">
        <include refid="SelectLargeCategory" />
        WHERE
            large_category_cd = '${largeCategoryCd}';
    </select>

    <select id="findAllSmallCategories" resultType="kakakucom.model.SmallCategory">
        <include refid="SelectSmallCategory" />
        ORDER BY
            sort_no ASC;
    </select>

    <select id="findSmallCategoriesByLargeCd" resultType="kakakucom.model.SmallCategory">
        <include refid="SelectSmallCategory" />
        WHERE
            large_category_cd = '${largeCategoryCd}';
    </select>

    <select id="countLargeCategoryByLargeCd" resultType="int">
        SELECT
            COUNT(large_category_cd)
        FROM
            large_category
        WHERE
            large_category_cd =  '${largeCategoryCd}';
    </select>

    <select id="countSmallCategoryBySmallCd" resultType="int">
        SELECT
            COUNT(small_category_cd)
        FROM
            small_category
        WHERE
            small_category_cd =  '${smallCategoryCd}';
    </select>

    <sql id="SelectLargeCategory">
        SELECT
            large_category_cd,
            name
        FROM
            large_category
    </sql>

    <sql id="SelectSmallCategory">
      SELECT
          small_category_cd,
          large_category_cd,
          name
      FROM
          small_category
    </sql>
</mapper>